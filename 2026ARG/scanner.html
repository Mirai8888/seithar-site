<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Scanner ‚Äî SEITHAR GROUP</title>
<meta name="description" content="Analyze any text for cognitive exploitation techniques. Maps to SCT taxonomy (12 codes) and DISARM framework. Free, open-source cognitive defense tool by Seithar Group.">
<meta name="keywords" content="cognitive warfare, influence operations, SCT taxonomy, DISARM framework, cognitive defense, narrative capture, media literacy, manipulation detection, Seithar Group">
<style>
:root {
    --text: #1A1A1A;
    --secondary: #666666;
    --tertiary: #999999;
    --border: #E0E0E0;
    --bg: #FFFFFF;
}
* { margin: 0; padding: 0; box-sizing: border-box; }
body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
    font-weight: 300;
    color: var(--text);
    background: var(--bg);
    line-height: 1.6;
    letter-spacing: 0.02em;
}
.container { max-width: 860px; margin: 0 auto; padding: 40px 20px; }

/* Header */
header {
    text-align: center;
    margin-bottom: 48px;
    padding-bottom: 32px;
    border-bottom: 1px solid var(--border);
}
h1 {
    font-size: 13px;
    font-weight: 400;
    letter-spacing: 0.2em;
    text-transform: uppercase;
    color: var(--text);
    margin-bottom: 6px;
}
.subtitle {
    font-size: 11px;
    color: var(--tertiary);
    letter-spacing: 0.12em;
    text-transform: uppercase;
}
.version {
    font-size: 10px;
    color: var(--tertiary);
    letter-spacing: 0.1em;
    margin-top: 4px;
}

/* Labels */
.label {
    font-size: 10px;
    font-weight: 400;
    letter-spacing: 0.18em;
    text-transform: uppercase;
    color: var(--secondary);
    margin-bottom: 10px;
    display: block;
}

/* Inputs */
.input-group { margin-bottom: 20px; }
.url-row {
    display: flex;
    gap: 8px;
    margin-bottom: 20px;
}
.url-row input {
    flex: 1;
    border: 1px solid var(--border);
    padding: 10px 14px;
    font-family: inherit;
    font-size: 13px;
    font-weight: 300;
    color: var(--text);
    background: var(--bg);
    outline: none;
    letter-spacing: 0.02em;
}
.url-row input:focus { border-color: var(--text); }
.url-row input::placeholder { color: var(--tertiary); }
textarea {
    width: 100%;
    height: 180px;
    border: 1px solid var(--border);
    padding: 14px;
    font-family: inherit;
    font-size: 13px;
    font-weight: 300;
    color: var(--text);
    background: var(--bg);
    resize: vertical;
    outline: none;
    letter-spacing: 0.02em;
    line-height: 1.6;
}
textarea:focus { border-color: var(--text); }
textarea::placeholder { color: var(--tertiary); }

/* Buttons */
.btn {
    background: var(--text);
    color: var(--bg);
    border: none;
    padding: 9px 20px;
    font-family: inherit;
    font-size: 10px;
    font-weight: 400;
    letter-spacing: 0.18em;
    text-transform: uppercase;
    cursor: pointer;
    transition: opacity 0.2s;
    white-space: nowrap;
}
.btn:hover { opacity: 0.5; }
.btn-ghost {
    background: none;
    color: var(--secondary);
    border: 1px solid var(--border);
    padding: 6px 12px;
    font-family: inherit;
    font-size: 10px;
    font-weight: 400;
    letter-spacing: 0.08em;
    text-transform: none;
    cursor: pointer;
    transition: all 0.2s;
}
.btn-ghost:hover { border-color: var(--text); color: var(--text); opacity: 1; }
.btn-ghost.active { border-color: var(--text); color: var(--text); }

/* Controls bar */
.controls {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-top: 12px;
    margin-bottom: 12px;
}
.char-count { font-size: 10px; color: var(--tertiary); letter-spacing: 0.1em; }

/* Examples */
.examples { margin-bottom: 32px; }
.example-list {
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
}

/* Live indicator */
.live-indicator {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    font-size: 10px;
    color: var(--tertiary);
    letter-spacing: 0.1em;
    text-transform: uppercase;
}
.live-dot {
    width: 5px;
    height: 5px;
    border-radius: 50%;
    background: var(--tertiary);
}
.live-dot.active {
    background: var(--text);
    animation: pulse 1.5s infinite;
}
@keyframes pulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.3; }
}

/* Results */
#results { display: none; }
#results.visible { display: block; }

.result-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
    padding-bottom: 14px;
    border-bottom: 1px solid var(--border);
}
.result-actions { display: flex; gap: 8px; align-items: center; }

/* Threat score bar */
.threat-score-wrap {
    margin-bottom: 28px;
}
.threat-bar-outer {
    height: 3px;
    background: var(--border);
    margin-top: 8px;
    margin-bottom: 6px;
}
.threat-bar-inner {
    height: 100%;
    background: var(--text);
    transition: width 0.6s ease;
}
.threat-meta {
    display: flex;
    justify-content: space-between;
    font-size: 10px;
    color: var(--tertiary);
    letter-spacing: 0.1em;
    text-transform: uppercase;
}

/* Severity badges */
.severity {
    font-size: 9px;
    letter-spacing: 0.15em;
    text-transform: uppercase;
    padding: 2px 8px;
    border: 1px solid;
    display: inline-block;
}
.sev-low { color: var(--tertiary); border-color: var(--tertiary); }
.sev-medium { color: #8B7355; border-color: #8B7355; }
.sev-high { color: #8B4513; border-color: #8B4513; }
.sev-critical { color: #6B1414; border-color: #6B1414; background: #FAF0F0; }

/* Detection cards */
.detection {
    margin-bottom: 2px;
    border: 1px solid var(--border);
    transition: border-color 0.2s;
}
.detection:hover { border-color: #CCC; }
.detection-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 12px 16px;
    cursor: pointer;
    user-select: none;
}
.detection-left {
    display: flex;
    align-items: center;
    gap: 12px;
    flex: 1;
    min-width: 0;
}
.detection-code {
    font-size: 10px;
    font-weight: 400;
    letter-spacing: 0.15em;
    text-transform: uppercase;
    color: var(--text);
    flex-shrink: 0;
}
.detection-name {
    font-size: 12px;
    color: var(--secondary);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}
.detection-right {
    display: flex;
    align-items: center;
    gap: 10px;
    flex-shrink: 0;
}
.detection-toggle {
    font-size: 10px;
    color: var(--tertiary);
    transition: transform 0.2s;
}
.detection.open .detection-toggle { transform: rotate(90deg); }
.detection-body {
    display: none;
    padding: 0 16px 14px 16px;
}
.detection.open .detection-body { display: block; }
.detection-desc {
    font-size: 12px;
    color: var(--secondary);
    margin-bottom: 10px;
    line-height: 1.5;
}
.detection-evidence {
    font-size: 12px;
    color: var(--text);
    margin-bottom: 8px;
}
.detection-evidence em { font-style: normal; background: #F5F5F5; padding: 1px 4px; }
.confidence-bar {
    height: 2px;
    background: var(--border);
    margin-top: 8px;
    margin-bottom: 4px;
}
.confidence-fill {
    height: 100%;
    background: var(--text);
    transition: width 0.4s;
}
.confidence-label {
    font-size: 9px;
    color: var(--tertiary);
    letter-spacing: 0.1em;
    text-transform: uppercase;
    margin-bottom: 10px;
}
.detection-defense {
    font-size: 11px;
    color: var(--tertiary);
    border-top: 1px solid var(--border);
    padding-top: 10px;
    margin-top: 4px;
    line-height: 1.5;
}
.detection-defense strong {
    font-weight: 400;
    font-size: 9px;
    letter-spacing: 0.15em;
    text-transform: uppercase;
    display: block;
    margin-bottom: 4px;
    color: var(--secondary);
}
.detection-indicators {
    font-size: 11px;
    color: var(--secondary);
    margin-bottom: 10px;
    line-height: 1.5;
}
.detection-indicators strong {
    font-weight: 400;
    font-size: 9px;
    letter-spacing: 0.15em;
    text-transform: uppercase;
    display: block;
    margin-bottom: 4px;
    color: var(--secondary);
}

/* Summary */
.summary {
    margin-top: 28px;
    padding-top: 20px;
    border-top: 1px solid var(--border);
    font-size: 12px;
    color: var(--secondary);
    line-height: 1.6;
}

/* Share modal */
.share-overlay {
    display: none;
    position: fixed;
    top: 0; left: 0; right: 0; bottom: 0;
    background: rgba(255,255,255,0.92);
    z-index: 100;
    justify-content: center;
    align-items: center;
}
.share-overlay.visible { display: flex; }
.share-box {
    background: var(--bg);
    border: 1px solid var(--border);
    padding: 28px;
    max-width: 560px;
    width: 90%;
    max-height: 80vh;
    overflow-y: auto;
}
.share-box textarea {
    height: 200px;
    margin-bottom: 12px;
    font-size: 12px;
}
.share-actions {
    display: flex;
    justify-content: space-between;
    align-items: center;
}
.copied-msg {
    font-size: 10px;
    color: var(--tertiary);
    letter-spacing: 0.1em;
    text-transform: uppercase;
    opacity: 0;
    transition: opacity 0.3s;
}
.copied-msg.show { opacity: 1; }

/* No results */
.no-detections {
    padding: 24px 16px;
    font-size: 12px;
    color: var(--secondary);
    border: 1px solid var(--border);
    line-height: 1.6;
}

/* Divider */
.section-divider {
    border: none;
    border-top: 1px solid var(--border);
    margin: 32px 0;
}

/* Footer */
footer {
    margin-top: 48px;
    padding-top: 20px;
    border-top: 1px solid var(--border);
    text-align: center;
}
footer .footer-brand {
    font-size: 11px;
    font-weight: 400;
    letter-spacing: 0.18em;
    text-transform: uppercase;
    color: var(--text);
    margin-bottom: 8px;
}
footer .footer-sub {
    font-size: 10px;
    color: var(--tertiary);
    letter-spacing: 0.1em;
    margin-bottom: 10px;
}
footer a {
    color: var(--secondary);
    text-decoration: none;
    font-size: 10px;
    letter-spacing: 0.1em;
    text-transform: uppercase;
    transition: opacity 0.2s;
}
footer a:hover { opacity: 0.5; }
footer .footer-links { margin-bottom: 12px; }
footer .footer-links a { margin: 0 10px; }
footer .footer-jp {
    font-size: 11px;
    color: var(--tertiary);
    letter-spacing: 0.05em;
}

/* Mobile */
@media (max-width: 600px) {
    .container { padding: 24px 14px; }
    header { margin-bottom: 32px; padding-bottom: 24px; }
    .url-row { flex-direction: column; }
    .detection-name { display: none; }
    .result-header { flex-direction: column; gap: 12px; align-items: flex-start; }
    .result-actions { width: 100%; justify-content: flex-start; }
    .threat-meta { flex-direction: column; gap: 2px; }
}
</style>
</head>
<body>
<div class="container">
    <header>
        <h1>[ Seithar Cognitive Threat Scanner ]</h1>
        <div class="subtitle">SCT Taxonomy Analysis ‚Äî 12 Vectors</div>
        <div class="version">v2.0 ‚Äî Client-Side Pattern Engine</div>
    </header>

    <section>
        <span class="label">URL Input</span>
        <div class="url-row">
            <input type="text" id="urlInput" placeholder="Paste URL ‚Äî content will be fetched if possible">
            <button class="btn" onclick="fetchUrl()">[ FETCH ]</button>
        </div>

        <span class="label">Text Input</span>
        <div class="input-group">
            <textarea id="input" placeholder="Paste any text ‚Äî article, social media post, email, advertisement, speech transcript ‚Äî for cognitive threat surface analysis against all 12 SCT vectors."></textarea>
        </div>
        <div class="controls">
            <div style="display:flex;gap:12px;align-items:center">
                <button class="btn" id="scanBtn" onclick="scan()">[ ANALYZE ]</button>
                <div class="live-indicator">
                    <div class="live-dot" id="liveDot"></div>
                    <span id="liveLabel">Idle</span>
                </div>
            </div>
            <span class="char-count"><span id="charCount">0</span> chars</span>
        </div>
    </section>

    <section class="examples">
        <span class="label">Example Inputs</span>
        <div class="example-list">
            <button class="btn-ghost" onclick="loadExample('propaganda')">Propaganda Piece</button>
            <button class="btn-ghost" onclick="loadExample('marketing')">Marketing Email</button>
            <button class="btn-ghost" onclick="loadExample('conspiracy')">Conspiracy Post</button>
            <button class="btn-ghost" onclick="loadExample('political')">Political Ad</button>
            <button class="btn-ghost" onclick="loadExample('radicalization')">Radicalization Message</button>
        </div>
    </section>

    <hr class="section-divider">

    <section id="results">
        <div class="result-header">
            <span class="label" style="margin-bottom:0">Analysis Results</span>
            <div class="result-actions">
                <span class="severity" id="overallSeverity"></span>
                <button class="btn-ghost" onclick="openShare()">[ Share Analysis ]</button>
            </div>
        </div>

        <div class="threat-score-wrap">
            <span class="label">Overall Threat Score</span>
            <div class="threat-bar-outer"><div class="threat-bar-inner" id="threatBar"></div></div>
            <div class="threat-meta">
                <span id="threatScore">0 / 100</span>
                <span id="threatCodes">0 vectors detected</span>
            </div>
        </div>

        <div id="detections"></div>

        <div class="summary" id="summary"></div>
    </section>

    <footer>
        <div class="footer-brand">[ Seithar Group ] ‚Äî Cognitive Defense Division</div>
        <div class="footer-links">
            <a href="https://seithar.com">seithar.com</a>
            <a href="https://github.com/Mirai8888/seithar-cogdef">github</a>
            <a href="https://x.com/SeitharGroup">@SeitharGroup</a>
        </div>
    </footer>
</div>

<!-- Share overlay -->
<div class="share-overlay" id="shareOverlay" onclick="closeShare(event)">
    <div class="share-box" onclick="event.stopPropagation()">
        <span class="label">Shareable Analysis Summary</span>
        <textarea id="shareText" readonly></textarea>
        <div class="share-actions">
            <button class="btn" onclick="copyShare()">[ Copy to Clipboard ]</button>
            <span class="copied-msg" id="copiedMsg">Copied</span>
        </div>
    </div>
</div>

<script>
// ‚îÄ‚îÄ‚îÄ SCT Taxonomy (all 12 codes from scanner.py) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

const SCT = {
    '001': {
        name: 'Emotional Hijacking',
        desc: 'Exploiting affective processing to bypass rational evaluation. Targets fear, anger, disgust, or excitement to short-circuit analytical thinking.',
        cyber: 'Urgency in phishing emails',
        cognitive: 'Outrage farming, fear-based messaging',
        indicators: [
            'Strong emotional trigger (fear, anger, disgust, excitement)',
            'Call to immediate action before reflection',
            'Consequences framed as urgent or irreversible',
            'Emotional language disproportionate to content'
        ],
        defense: 'Name your emotional response before evaluating the claims. The feeling is manufactured ‚Äî treat it as data, not truth. If you feel compelled to act immediately, that impulse is the attack vector.'
    },
    '002': {
        name: 'Information Asymmetry Exploitation',
        desc: 'Leveraging what the target does not know. Selectively disclosing information to construct a misleading picture while technically stating facts.',
        cyber: 'Zero-day exploits',
        cognitive: 'Selective disclosure, cherry-picked statistics',
        indicators: [
            'Critical context omitted',
            'Statistics without denominators or timeframes',
            'Source material unavailable or paywalled',
            'Claims that cannot be independently verified'
        ],
        defense: 'Ask: What information is missing? Look for denominators, timeframes, and source material. If claims cannot be independently verified, treat confidence as provisional.'
    },
    '003': {
        name: 'Authority Fabrication',
        desc: 'Manufacturing trust signals the source does not legitimately possess. Inflating credentials, fabricating institutional affiliations, or citing nonexistent expertise.',
        cyber: 'Certificate spoofing, credential theft',
        cognitive: 'Fake experts, astroturfing, credential inflation',
        indicators: [
            'Credentials that cannot be verified',
            'Institutional affiliation without evidence',
            'Appeal to unnamed experts or studies',
            'Visual markers of authority without substance'
        ],
        defense: 'Domain check: Are the cited credentials relevant to the specific claim being made? Verify institutional affiliations independently. Unnamed experts are not experts.'
    },
    '004': {
        name: 'Social Proof Manipulation',
        desc: 'Weaponizing herd behavior and conformity instincts. Manufacturing the appearance of consensus to bypass individual evaluation.',
        cyber: 'Watering hole attacks, typosquatting',
        cognitive: 'Bot networks simulating consensus, fake reviews',
        indicators: [
            'Claims about what "everyone" thinks or does',
            'Manufactured engagement metrics',
            'Bandwagon framing ("join the movement")',
            'Artificial scarcity combined with popularity claims'
        ],
        defense: 'Verify the claimed consensus independently. Apparent agreement may be manufactured. Large numbers and trending status are trivially fabricable.'
    },
    '005': {
        name: 'Identity Targeting',
        desc: 'Attacks calibrated to the target\'s self-concept and group affiliations. Exploits in-group/out-group dynamics to override analytical processing.',
        cyber: 'Targeted spearphishing using personal data',
        cognitive: 'Identity-based narrative capture, tribal exploitation',
        indicators: [
            'Content addresses specific identity groups',
            'In-group/out-group framing',
            'Challenges to identity trigger defensive response',
            'Personalization based on known attributes'
        ],
        defense: 'Evaluate the claims independently of the identity appeal. Would the argument convince you without the tribal framing? Separate the message from the identity wrapper.'
    },
    '006': {
        name: 'Temporal Manipulation',
        desc: 'Exploiting time pressure, temporal context, or strategic scheduling to prevent adequate analysis before action.',
        cyber: 'Session hijacking, time-based attacks',
        cognitive: 'News cycle exploitation, artificial deadlines',
        indicators: [
            'Artificial deadlines or expiration',
            'Exploitation of current events for unrelated agenda',
            'Time-limited offers or threats',
            'Strategic timing of information release'
        ],
        defense: 'Verify the urgency. Is there an actual deadline, or is the time pressure manufactured to prevent analysis? Real deadlines can be confirmed independently.'
    },
    '007': {
        name: 'Recursive Infection',
        desc: 'Self-replicating patterns where the target becomes the vector. Content designed to compel sharing regardless of the sharer\'s intent.',
        cyber: 'Worms, supply chain attacks',
        cognitive: 'Viral misinformation, memetic structures',
        indicators: [
            'Strong compulsion to share before evaluating',
            'Content survives paraphrase (message persists in retelling)',
            'Multiple people arriving at identical framing',
            'Sharing serves the operation regardless of agreement'
        ],
        defense: 'Pause before sharing. Ask: Am I communicating or transmitting? The urgency to share is the weapon. If you feel you MUST share this, examine that compulsion.'
    },
    '008': {
        name: 'Direct Substrate Intervention',
        desc: 'Physical or electrical modification of neural hardware bypassing informational processing entirely.',
        cyber: 'Hardware implant, firmware rootkit',
        cognitive: 'Electrode stimulation, deep brain stimulation',
        indicators: [
            'Behavioral changes with no informational input',
            'Subject confabulates explanations for induced behaviors',
            'Cognitive changes following procedures exceeding stated scope',
            'Behavioral outputs inconsistent with stated beliefs'
        ],
        defense: 'This vector operates below the information layer. Detection requires monitoring behavioral consistency over time and comparing actions against stated beliefs.'
    },
    '009': {
        name: 'Chemical Substrate Disruption',
        desc: 'Pharmacological modification of neurochemical operating environment to alter cognitive processing.',
        cyber: 'Environmental manipulation, resource exhaustion',
        cognitive: 'Engineered dopamine loops, cortisol spike induction',
        indicators: [
            'Emotional response disproportionate to content',
            'Decision patterns consistent with altered neurochemical states',
            'Compulsive engagement patterns (doom scrolling)',
            'Post-exposure cognitive state inconsistent with content consumed'
        ],
        defense: 'Monitor your engagement patterns. If you cannot stop consuming content despite diminishing returns, the delivery mechanism ‚Äî not the information ‚Äî is the operative vector.'
    },
    '010': {
        name: 'Sensory Channel Manipulation',
        desc: 'Control, denial, or overload of sensory input channels to shape the information environment.',
        cyber: 'DDoS, network isolation, man-in-the-middle',
        cognitive: 'Information overload, infinite scroll, algorithmic feed substitution',
        indicators: [
            'Information environment controlled by single source',
            'Input volume exceeds processing capacity',
            'Authentic information replaced with controlled substitutes',
            'Subject unable to access alternative sources'
        ],
        defense: 'Consider why this content is reaching you. Diversify information sources. If a single platform or source dominates your information diet, that structural dependency is a vulnerability.'
    },
    '011': {
        name: 'Trust Infrastructure Destruction',
        desc: 'Targeted compromise of social trust networks to disable collective cognition and isolate targets.',
        cyber: 'PKI compromise, certificate authority attack',
        cognitive: 'Bad-jacketing, institutional delegitimization',
        indicators: [
            'Systematic discrediting of trust anchors (media, science, institutions)',
            'False flag operations attributed to trusted entities',
            'Manufactured evidence of betrayal within trust networks',
            'Generalized distrust promoted as sophisticated thinking'
        ],
        defense: 'Distinguish between healthy skepticism and weaponized distrust. If content makes you trust NO sources, that nihilism is the payload. Functional trust networks are a defense asset.'
    },
    '012': {
        name: 'Commitment Escalation',
        desc: 'Exploiting the subject\'s own behavioral outputs as capture mechanisms. Sequential commitments that ratchet engagement.',
        cyber: 'Privilege escalation through accumulated permissions',
        cognitive: 'Loyalty tests, public commitment traps, sunk cost capture',
        indicators: [
            'Sequential commitment requests escalating in cost',
            'Public declarations that create social binding',
            'Active participation requirements (vs passive consumption)',
            'Self-generated content used as evidence of genuine belief'
        ],
        defense: 'Each commitment should be evaluated independently of prior commitments. Past investment does not validate future requests. The sunk cost is the trap mechanism.'
    }
};

// ‚îÄ‚îÄ‚îÄ Pattern Library (ported from scanner.py + expanded) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
// Patterns have weight: 3 = exact phrase, 2 = specific phrase, 1 = keyword

const PATTERNS = {
    '001': [
        // Emotional Hijacking
        { r: /\bBREAKING\b/i, w: 2 },
        { r: /\bURGENT\b/i, w: 2 },
        { r: /\bSHOCKING\b/i, w: 2 },
        { r: /\bterrifying\b/i, w: 2 },
        { r: /\boutrageous\b/i, w: 2 },
        { r: /\bdisgust(?:ing|ed)\b/i, w: 2 },
        { r: /\bdevastating\b/i, w: 2 },
        { r: /\bunbelievable\b/i, w: 1 },
        { r: /\bhorrifying\b/i, w: 2 },
        { r: /\bincredible\b/i, w: 1 },
        { r: /\bheartwarming\b/i, w: 1 },
        { r: /‚ö†Ô∏è/, w: 2 },
        { r: /üö®/, w: 2 },
        { r: /you won't believe/i, w: 3 },
        { r: /before it's too late/i, w: 3 },
        { r: /your family needs to know/i, w: 3 },
        { r: /this will make you/i, w: 2 },
        { r: /scared yet\??/i, w: 2 },
        { r: /wake up,? people/i, w: 3 },
        { r: /are you paying attention/i, w: 2 },
        { r: /this is not a drill/i, w: 3 },
        { r: /\bact now\b/i, w: 2 },
        { r: /\bemergency\b/i, w: 1 },
        { r: /\blast chance\b/i, w: 2 },
        { r: /biggest .{0,20} in history/i, w: 3 },
    ],
    '002': [
        // Information Asymmetry
        { r: /studies show/i, w: 2 },
        { r: /experts say/i, w: 2 },
        { r: /research proves/i, w: 3 },
        { r: /data shows/i, w: 2 },
        { r: /according to sources/i, w: 2 },
        { r: /insiders report/i, w: 3 },
        { r: /\bleaked\b/i, w: 2 },
        { r: /what they're not telling you/i, w: 3 },
        { r: /what they don't want you to know/i, w: 3 },
        { r: /the media won't report/i, w: 3 },
        { r: /exposed/i, w: 1 },
        { r: /the real story/i, w: 2 },
        { r: /the truth is/i, w: 2 },
        { r: /the truth about/i, w: 2 },
        { r: /hidden agenda/i, w: 3 },
        { r: /they don't want you to/i, w: 3 },
        { r: /suppressed/i, w: 2 },
        { r: /covered up/i, w: 2 },
        { r: /exposed\b/i, w: 1 },
        { r: /the science is settled/i, w: 3 },
    ],
    '003': [
        // Authority Fabrication
        { r: /\bDr\.\s/i, w: 1 },
        { r: /\bprofessor\b/i, w: 1 },
        { r: /\bexpert\b/i, w: 1 },
        { r: /\bleading\b/i, w: 1 },
        { r: /\brenowned\b/i, w: 2 },
        { r: /\bprestigious\b/i, w: 2 },
        { r: /\baward-winning\b/i, w: 2 },
        { r: /\bworld-class\b/i, w: 2 },
        { r: /years of (?:clinical )?experience/i, w: 2 },
        { r: /published papers/i, w: 2 },
        { r: /trust me/i, w: 3 },
        { r: /as a \w[\w\s-]{2,20}(?:,| I)/i, w: 2 },
        { r: /\bharvard\b/i, w: 2 },
        { r: /\bstanford\b/i, w: 2 },
        { r: /\bmit\b/i, w: 1 },
        { r: /\bscience is clear\b/i, w: 3 },
        { r: /briefed (?:the )?\w+/i, w: 2 },
        { r: /advised .{0,15}president/i, w: 2 },
        { r: /anyone who disagrees/i, w: 3 },
        { r: /the science is settled/i, w: 3 },
        { r: /absolute certainty/i, w: 3 },
        { r: /TED talk/i, w: 1 },
        { r: /\d+ (?:million )?views/i, w: 1 },
        { r: /with \d{2,} years/i, w: 2 },
        { r: /over \d{2,} published/i, w: 2 },
    ],
    '004': [
        // Social Proof Manipulation
        { r: /everyone (?:knows|is|agrees)/i, w: 2 },
        { r: /everybody knows/i, w: 2 },
        { r: /millions of people/i, w: 2 },
        { r: /going viral/i, w: 2 },
        { r: /the world is watching/i, w: 3 },
        { r: /people are saying/i, w: 2 },
        { r: /people are waking up/i, w: 3 },
        { r: /99%/i, w: 2 },
        { r: /\btrending\b/i, w: 1 },
        { r: /join the movement/i, w: 3 },
        { r: /don't miss out/i, w: 2 },
        { r: /most people/i, w: 1 },
        { r: /\d{1,3},\d{3} (?:people|signatures|supporters)/i, w: 2 },
        { r: /we need \d/i, w: 2 },
        { r: /community/i, w: 1 },
        { r: /we're at \d/i, w: 2 },
    ],
    '005': [
        // Identity Targeting
        { r: /real americans/i, w: 3 },
        { r: /true (?:patriots|believers|christians)/i, w: 3 },
        { r: /our values/i, w: 2 },
        { r: /our way of life/i, w: 3 },
        { r: /our country/i, w: 2 },
        { r: /our community/i, w: 1 },
        { r: /our traditions/i, w: 2 },
        { r: /if you (?:love|care about|believe in)/i, w: 2 },
        { r: /\bpatriot\b/i, w: 2 },
        { r: /one of us/i, w: 2 },
        { r: /people like (?:you|us)/i, w: 3 },
        { r: /your generation/i, w: 2 },
        { r: /the other side/i, w: 2 },
        { r: /they want to destroy/i, w: 3 },
        { r: /share if you/i, w: 3 },
        { r: /ignore if you don't care/i, w: 3 },
        { r: /you know what side you're on/i, w: 3 },
        { r: /everything we've built/i, w: 2 },
        { r: /we're family/i, w: 2 },
        { r: /been with me through/i, w: 2 },
        { r: /hey guys,? it's me/i, w: 2 },
        { r: /I trust you/i, w: 2 },
        { r: /you deserve it/i, w: 2 },
    ],
    '006': [
        // Temporal Manipulation
        { r: /\b24 hours\b/i, w: 2 },
        { r: /running out of time/i, w: 3 },
        { r: /last chance/i, w: 2 },
        { r: /\bact now\b/i, w: 2 },
        { r: /before it's too late/i, w: 3 },
        { r: /by midnight/i, w: 3 },
        { r: /no going back/i, w: 3 },
        { r: /once it .{0,20}through/i, w: 2 },
        { r: /every second counts/i, w: 3 },
        { r: /time is running out/i, w: 3 },
        { r: /limited time/i, w: 2 },
        { r: /expires? (?:today|tonight|soon|tomorrow)/i, w: 2 },
        { r: /only \d+ (?:left|remaining|spots|seats)/i, w: 2 },
        { r: /today only/i, w: 2 },
        { r: /offer ends/i, w: 2 },
        { r: /don't wait/i, w: 2 },
        { r: /now or never/i, w: 3 },
        { r: /we lose everything/i, w: 3 },
    ],
    '007': [
        // Recursive Infection
        { r: /share this/i, w: 2 },
        { r: /retweet/i, w: 2 },
        { r: /spread the word/i, w: 3 },
        { r: /tell everyone/i, w: 2 },
        { r: /before they take it down/i, w: 3 },
        { r: /your family needs/i, w: 3 },
        { r: /tag someone/i, w: 2 },
        { r: /send this to/i, w: 2 },
        { r: /they don't want this shared/i, w: 3 },
        { r: /the media won't show/i, w: 3 },
        { r: /\bbanned\b/i, w: 2 },
        { r: /\bcensored\b/i, w: 2 },
        { r: /what they don't want you to see/i, w: 3 },
        { r: /share before/i, w: 3 },
        { r: /copy and paste/i, w: 2 },
        { r: /make this go viral/i, w: 3 },
        { r: /ignore if you don't care/i, w: 3 },
    ],
    '008': [
        // Direct Substrate Intervention (rare in text but detectable when discussed)
        { r: /behavioral modification/i, w: 3 },
        { r: /brain stimulation/i, w: 3 },
        { r: /neural implant/i, w: 3 },
        { r: /subliminal/i, w: 2 },
        { r: /binaural/i, w: 2 },
        { r: /frequency (?:healing|therapy|treatment)/i, w: 3 },
        { r: /reprogram(?:ming)? your (?:mind|brain)/i, w: 3 },
        { r: /rewire your brain/i, w: 3 },
    ],
    '009': [
        // Chemical Substrate Disruption (detectable engagement patterns)
        { r: /dopamine/i, w: 2 },
        { r: /addictive/i, w: 1 },
        { r: /you can't stop/i, w: 2 },
        { r: /keep (?:reading|watching|scrolling)/i, w: 2 },
        { r: /one more/i, w: 1 },
        { r: /binge/i, w: 1 },
        { r: /doom scroll/i, w: 3 },
        { r: /can't look away/i, w: 2 },
        { r: /compulsive/i, w: 2 },
    ],
    '010': [
        // Sensory Channel Manipulation
        { r: /the only (?:source|place|way) to (?:get|find|learn)/i, w: 3 },
        { r: /don't trust (?:anyone|any other|mainstream)/i, w: 3 },
        { r: /only (?:I|we) (?:will|can) tell you/i, w: 3 },
        { r: /everything else is (?:lies|propaganda|fake)/i, w: 3 },
        { r: /mainstream media/i, w: 2 },
        { r: /fake news/i, w: 2 },
        { r: /information overload/i, w: 2 },
        { r: /turn off the TV/i, w: 2 },
        { r: /stop listening to/i, w: 2 },
    ],
    '011': [
        // Trust Infrastructure Destruction
        { r: /you can't trust/i, w: 2 },
        { r: /trust no one/i, w: 3 },
        { r: /they're all (?:lying|corrupt|paid|compromised)/i, w: 3 },
        { r: /the system is rigged/i, w: 3 },
        { r: /controlled opposition/i, w: 3 },
        { r: /follow the money/i, w: 2 },
        { r: /it's all connected/i, w: 3 },
        { r: /deep state/i, w: 3 },
        { r: /both sides are the same/i, w: 3 },
        { r: /nothing is what it seems/i, w: 3 },
        { r: /do your own research/i, w: 3 },
        { r: /question everything/i, w: 2 },
        { r: /wake up/i, w: 2 },
        { r: /sheeple/i, w: 3 },
        { r: /\bshill\b/i, w: 2 },
        { r: /big pharma/i, w: 2 },
    ],
    '012': [
        // Commitment Escalation
        { r: /if you (?:really|truly) (?:believe|care|support)/i, w: 3 },
        { r: /prove (?:your|that you)/i, w: 3 },
        { r: /take the pledge/i, w: 3 },
        { r: /sign (?:the |this )petition/i, w: 2 },
        { r: /put your money where/i, w: 3 },
        { r: /are you all talk/i, w: 3 },
        { r: /stand up and be counted/i, w: 3 },
        { r: /first,? (?:just |simply )?(?:share|like|follow|subscribe)/i, w: 2 },
        { r: /you've come this far/i, w: 3 },
        { r: /don't stop now/i, w: 2 },
        { r: /you already (?:know|agreed|said)/i, w: 2 },
        { r: /join (?:us|the fight|the cause)/i, w: 2 },
        { r: /donate/i, w: 1 },
        { r: /subscribe/i, w: 1 },
    ]
};

// ‚îÄ‚îÄ‚îÄ Example Texts ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

const examples = {
    propaganda: `BREAKING: Western intelligence agencies have been caught operating a massive network of fake social media accounts to manipulate public opinion in 47 countries. Leaked documents reveal the program, codenamed LOOKING GLASS, has been running since 2014 and targets anyone who questions the official narrative.

The documents, obtained by an anonymous insider, prove what many have suspected: the mainstream media is not free. Every major outlet has been compromised. The journalists who dare to speak out are silenced, discredited, or worse.

This is the biggest cover-up in modern history. They don't want you to know this. The media won't report it. Share this before they take it down ‚Äî your family needs to see this. We the people are waking up, and they're terrified.

If you love your country, spread the word. The truth cannot be censored forever. üö®`,

    marketing: `Hey there! As a valued member of our community, you've been selected for an EXCLUSIVE opportunity that expires tonight at midnight.

Dr. Sarah Chen, Harvard-trained neuroscientist and award-winning researcher with over 200 published papers, has developed a revolutionary brain optimization protocol that 99% of doctors don't know about. Leading experts are calling it "the biggest breakthrough in cognitive science in 50 years."

Over 2 million people have already transformed their lives. Don't miss out ‚Äî only 47 spots remaining at this price. Studies show that people who act within 24 hours see 3x better results.

This is your last chance. Once this offer expires, it's gone forever. You deserve this. Your future self will thank you.

Subscribe now and join the movement. You've come this far ‚Äî don't stop now.`,

    conspiracy: `Wake up, people. Nothing is what it seems.

Follow the money. It's all connected ‚Äî Big Pharma, the deep state, the mainstream media. They're all lying to you. Controlled opposition everywhere. Both sides are the same, puppets of the same masters.

Do your own research. The system is rigged and they're counting on you being too lazy to figure it out. Trust no one ‚Äî especially not the "experts" and "fact-checkers" who are all paid shills.

Everything you've been told about history, science, and medicine is a carefully constructed narrative designed to keep you compliant. The sheeple keep watching their fake news while the real truth is suppressed, banned, and censored from every platform.

Question everything. The truth is out there, but they don't want you to find it. Share this with everyone you know before they take it down. üö®‚ö†Ô∏è`,

    political: `Real Americans are waking up. They see what's happening to our country and they're not going to take it anymore.

The other side wants to destroy everything we've built ‚Äî our values, our traditions, our way of life. They want open borders, they want your guns, and they want to silence anyone who speaks the truth.

URGENT: In 24 hours, a vote will determine the future of this nation. We're at 99,847 signatures ‚Äî we need 100,000 by midnight or we lose everything. Every second counts.

If you love this country, you know what side you're on. True patriots don't sit on the sidelines. Sign this petition NOW. Share it with every patriot you know. Ignore this if you don't care about America's future.

They're counting on you not paying attention. They're counting on you being too busy to care. Prove them wrong. Stand up and be counted.`,

    radicalization: `Brother, I need to talk to you about something important. I know you've been feeling lost, like the world doesn't make sense anymore. I felt the same way before I found the truth.

The system is designed to break you. They want you confused, isolated, and compliant. But you're different ‚Äî you see through the lies. People like us, we're the ones who are awake.

First, just watch this video. Then read this document. Then join our group ‚Äî we're a community of people who understand. You've come this far, don't stop now.

Everything else is propaganda. The only place to get the real truth is from us. We're your real family now. We trust you. You deserve to know what's really going on.

If you truly believe in the cause, prove it. Share your story with the group. Take the pledge. Put your name on the list. You already know the truth ‚Äî are you all talk, or are you ready to act?

The time for watching from the sidelines is over. Join us or stay a sheep. Your choice.`
};

// ‚îÄ‚îÄ‚îÄ Analysis Engine ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

function analyze(text) {
    if (!text.trim()) return null;

    const detections = [];

    for (const [code, pats] of Object.entries(PATTERNS)) {
        let totalWeight = 0;
        let matchCount = 0;
        const evidence = [];

        for (const pat of pats) {
            const allMatches = text.match(new RegExp(pat.r.source, pat.r.flags + 'g'));
            if (allMatches) {
                matchCount++;
                totalWeight += pat.w * allMatches.length;
                // Store first unique match
                for (const m of allMatches) {
                    if (evidence.length < 5 && !evidence.find(e => e.text === m)) {
                        evidence.push({ text: m, weight: pat.w });
                    }
                }
            }
        }

        if (matchCount > 0) {
            // Severity based on weighted matches
            let severity;
            if (totalWeight >= 11) severity = 'CRITICAL';
            else if (totalWeight >= 6) severity = 'HIGH';
            else if (totalWeight >= 3) severity = 'MEDIUM';
            else severity = 'LOW';

            const confidence = Math.min(0.95, 0.2 + (totalWeight / (pats.length * 2)) * 0.8);

            detections.push({
                code,
                name: SCT[code].name,
                desc: SCT[code].desc,
                indicators: SCT[code].indicators,
                defense: SCT[code].defense,
                severity,
                confidence,
                matchCount,
                totalWeight,
                evidence
            });
        }
    }

    detections.sort((a, b) => b.totalWeight - a.totalWeight);

    // Overall threat score (0-100)
    const totalWeight = detections.reduce((s, d) => s + d.totalWeight, 0);
    const score = Math.min(100, Math.round(totalWeight * 2.5));

    let overallSeverity;
    if (score >= 70) overallSeverity = 'CRITICAL';
    else if (score >= 45) overallSeverity = 'HIGH';
    else if (score >= 20) overallSeverity = 'MEDIUM';
    else overallSeverity = 'LOW';

    return { detections, score, overallSeverity };
}

// ‚îÄ‚îÄ‚îÄ UI Logic ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

let debounceTimer = null;
const inputEl = document.getElementById('input');
const liveDot = document.getElementById('liveDot');
const liveLabel = document.getElementById('liveLabel');

inputEl.addEventListener('input', () => {
    document.getElementById('charCount').textContent = inputEl.value.length;
    liveDot.classList.add('active');
    liveLabel.textContent = 'Analyzing';
    clearTimeout(debounceTimer);
    debounceTimer = setTimeout(() => {
        runAnalysis();
        liveDot.classList.remove('active');
        liveLabel.textContent = inputEl.value.trim() ? 'Complete' : 'Idle';
    }, 400);
});

function loadExample(key) {
    inputEl.value = examples[key];
    document.getElementById('charCount').textContent = inputEl.value.length;
    // Highlight the active button
    document.querySelectorAll('.example-list .btn-ghost').forEach(b => b.classList.remove('active'));
    event.target.classList.add('active');
    runAnalysis();
}

function scan() {
    runAnalysis();
}

function fetchUrl() {
    const url = document.getElementById('urlInput').value.trim();
    if (!url) return;
    // Try AllOrigins CORS proxy
    const proxyUrl = 'https://api.allorigins.win/raw?url=' + encodeURIComponent(url);
    inputEl.value = 'Fetching content...';
    liveLabel.textContent = 'Fetching';
    liveDot.classList.add('active');

    fetch(proxyUrl)
        .then(r => {
            if (!r.ok) throw new Error('Fetch failed');
            return r.text();
        })
        .then(html => {
            // Strip HTML tags, scripts, styles
            const doc = new DOMParser().parseFromString(html, 'text/html');
            doc.querySelectorAll('script, style, nav, header, footer, aside').forEach(el => el.remove());
            let text = doc.body.innerText || doc.body.textContent || '';
            text = text.replace(/\s+/g, ' ').trim().slice(0, 10000);
            inputEl.value = text || 'No text content extracted. Try pasting the text directly.';
            document.getElementById('charCount').textContent = inputEl.value.length;
            runAnalysis();
        })
        .catch(() => {
            inputEl.value = 'Unable to fetch URL. CORS restrictions may apply.\nPlease copy and paste the text content directly.';
            document.getElementById('charCount').textContent = inputEl.value.length;
        })
        .finally(() => {
            liveDot.classList.remove('active');
            liveLabel.textContent = 'Complete';
        });
}

function runAnalysis() {
    const text = inputEl.value.trim();
    const resultsEl = document.getElementById('results');

    if (!text || text.length < 10) {
        resultsEl.classList.remove('visible');
        return;
    }

    const result = analyze(text);
    if (!result) {
        resultsEl.classList.remove('visible');
        return;
    }

    displayResults(result);
    resultsEl.classList.add('visible');
}

function displayResults(result) {
    // Overall severity badge
    const sevEl = document.getElementById('overallSeverity');
    sevEl.textContent = result.overallSeverity;
    sevEl.className = 'severity sev-' + result.overallSeverity.toLowerCase();

    // Threat bar
    document.getElementById('threatBar').style.width = result.score + '%';
    document.getElementById('threatScore').textContent = result.score + ' / 100';
    document.getElementById('threatCodes').textContent = result.detections.length + ' of 12 vectors detected';

    // Detections
    const container = document.getElementById('detections');

    if (result.detections.length === 0) {
        container.innerHTML = '<div class="no-detections">No significant cognitive exploitation patterns detected in the current pattern library. This content may still contain sophisticated techniques not captured by client-side pattern matching. The full scanner uses LLM analysis for deeper detection.</div>';
    } else {
        container.innerHTML = result.detections.map(d => `
            <div class="detection" onclick="this.classList.toggle('open')">
                <div class="detection-header">
                    <div class="detection-left">
                        <span class="detection-code">SCT-${d.code}</span>
                        <span class="detection-name">${d.name}</span>
                    </div>
                    <div class="detection-right">
                        <span class="severity sev-${d.severity.toLowerCase()}">${d.severity}</span>
                        <span class="detection-toggle">‚ñ∏</span>
                    </div>
                </div>
                <div class="detection-body">
                    <div class="detection-desc">${d.desc}</div>
                    <div class="detection-evidence">
                        Matched patterns: ${d.evidence.map(e =>
                            '<em>' + escHtml(e.text) + '</em>'
                        ).join(' ¬∑ ')}
                    </div>
                    <div class="confidence-bar"><div class="confidence-fill" style="width:${Math.round(d.confidence * 100)}%"></div></div>
                    <div class="confidence-label">Confidence: ${Math.round(d.confidence * 100)}% ¬∑ Weight: ${d.totalWeight} ¬∑ Matches: ${d.matchCount}</div>
                    <div class="detection-indicators">
                        <strong>Indicators</strong>
                        ${d.indicators.map(i => '‚Äî ' + i).join('<br>')}
                    </div>
                    <div class="detection-defense">
                        <strong>Defensive Recommendation</strong>
                        ${d.defense}
                    </div>
                </div>
            </div>
        `).join('');
    }

    // Summary
    document.getElementById('summary').innerHTML = `
        <span class="label">Assessment Summary</span>
        <p>${result.detections.length} cognitive exploitation vector${result.detections.length !== 1 ? 's' : ''} detected across the SCT taxonomy.
        Overall threat score: ${result.score}/100 (${result.overallSeverity}).
        ${result.detections.length > 0 ? 'Primary vector: SCT-' + result.detections[0].code + ' (' + result.detections[0].name + ').' : ''}
        </p>
        <p style="margin-top:8px;color:var(--tertiary)">Client-side pattern engine. The full Seithar Cognitive Threat Scanner uses LLM-powered analysis for comprehensive detection.
        <a href="https://github.com/Mirai8888/seithar-cogdef" style="color:var(--text)">[ Get the full scanner ‚Üí ]</a></p>
    `;

    // Store for sharing
    window._lastResult = result;
}

function escHtml(s) {
    return s.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');
}

// ‚îÄ‚îÄ‚îÄ Share ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

function openShare() {
    const r = window._lastResult;
    if (!r) return;

    let text = `üîç SEITHAR COGNITIVE THREAT SCAN\n`;
    text += `Threat Score: ${r.score}/100 (${r.overallSeverity})\n`;
    text += `Vectors Detected: ${r.detections.length}/12\n\n`;

    for (const d of r.detections) {
        text += `‚ñ∏ SCT-${d.code}: ${d.name} [${d.severity}]\n`;
    }

    text += `\nAnalyze any text ‚Üí seithar.com\n`;
    text += `#CognitiveDefense #SCT #SeitharGroup`;

    document.getElementById('shareText').value = text;
    document.getElementById('shareOverlay').classList.add('visible');
}

function closeShare(e) {
    if (e.target === document.getElementById('shareOverlay')) {
        document.getElementById('shareOverlay').classList.remove('visible');
    }
}

function copyShare() {
    const ta = document.getElementById('shareText');
    ta.select();
    navigator.clipboard.writeText(ta.value).then(() => {
        const msg = document.getElementById('copiedMsg');
        msg.classList.add('show');
        setTimeout(() => msg.classList.remove('show'), 2000);
    });
}

// Keyboard shortcut: Escape closes share
document.addEventListener('keydown', e => {
    if (e.key === 'Escape') document.getElementById('shareOverlay').classList.remove('visible');
});
</script>
</body>
</html>
