<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Network Topology — SEITHAR GROUP</title>
<meta name="description" content="Community network analysis of @gOPwbi7qqtWeD9o. 279 nodes, 1599 edges, 5 communities. Seithar Group cognitive operations research.">
<style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body {
    font-family: -apple-system, BlinkMacSystemFont, 'Helvetica Neue', Helvetica, Arial, sans-serif;
    background: #ffffff;
    color: #1a1a1a;
    overflow: hidden;
    height: 100vh;
    -webkit-font-smoothing: antialiased;
}
#graph { width: 100vw; height: 100vh; }
.header {
    position: absolute; top: 24px; left: 32px; z-index: 10;
}
.header h1 {
    font-size: 13px; font-weight: 300; letter-spacing: 0.15em;
    text-transform: uppercase; color: #1a1a1a; margin-bottom: 4px;
}
.header p {
    font-size: 10px; letter-spacing: 0.08em; color: #999;
    text-transform: uppercase;
}
.header .note {
    font-size: 9px; color: #999; margin-top: 8px; letter-spacing: 0.03em;
    text-transform: none; line-height: 1.5;
}
.search-box {
    position: absolute; top: 24px; right: 32px; z-index: 10;
}
.search-box input {
    font-family: inherit; font-size: 11px; font-weight: 300;
    border: none; border-bottom: 1px solid #e0e0e0;
    padding: 4px 0; width: 160px; outline: none;
    color: #1a1a1a; background: transparent; letter-spacing: 0.03em;
}
.search-box input::placeholder { color: #ccc; }
.search-box input:focus { border-bottom-color: #1a1a1a; }
.legend {
    position: absolute; bottom: 32px; left: 32px; z-index: 10;
}
.legend-title {
    font-size: 9px; letter-spacing: 0.12em; text-transform: uppercase;
    color: #999; margin-bottom: 8px;
}
.legend-item {
    display: flex; align-items: center; gap: 8px;
    font-size: 10px; color: #666; margin-bottom: 5px;
    letter-spacing: 0.02em; font-weight: 300;
}
.legend-dot {
    width: 8px; height: 8px; border-radius: 50%; flex-shrink: 0;
}
.legend-diamond {
    width: 8px; height: 8px; flex-shrink: 0;
    transform: rotate(45deg);
}
.stats {
    position: absolute; bottom: 32px; right: 32px; z-index: 10;
    text-align: right;
}
.stats div {
    font-size: 9px; letter-spacing: 0.08em; text-transform: uppercase;
    color: #999; margin-bottom: 3px; font-weight: 300;
}
.back-link {
    position: absolute; bottom: 32px; left: 50%; transform: translateX(-50%);
    z-index: 10; font-size: 11px; letter-spacing: 0.08em;
    text-transform: uppercase; color: #1a1a1a; text-decoration: none;
    font-weight: 400;
}
.back-link:hover { opacity: 0.5; }
.tooltip {
    position: absolute; pointer-events: none; display: none;
    background: #fff; border: 1px solid #e0e0e0;
    padding: 10px 14px; z-index: 100;
    box-shadow: 0 2px 12px rgba(0,0,0,0.06);
}
.tooltip .tt-name {
    font-size: 12px; font-weight: 400; letter-spacing: 0.04em;
    color: #1a1a1a; margin-bottom: 4px;
}
.tooltip .tt-detail {
    font-size: 10px; color: #666; font-weight: 300;
    line-height: 1.6; letter-spacing: 0.02em;
}
.tooltip .tt-role {
    font-size: 9px; text-transform: uppercase; letter-spacing: 0.1em;
    margin-top: 4px; font-weight: 400;
}
</style>
</head>
<body>
<div class="header">
    <h1>Seithar Group</h1>
    <p>Network Topology / @gOPwbi7qqtWeD9o / 認知作戦</p>
    <div class="note">
        ◇ Diamond nodes are cross-community bridges.<br>
        Node size reflects PageRank. Click to isolate connections.
    </div>
</div>
<div class="search-box">
    <input type="text" id="search" placeholder="Search username...">
</div>
<svg id="graph"></svg>
<div class="legend">
    <div class="legend-title">Communities</div>
    <div class="legend-item"><div class="legend-dot" style="background:#8b9daf"></div>Dissident Right / NRx Aesthetics</div>
    <div class="legend-item"><div class="legend-dot" style="background:#b5a693"></div>Crypto-Occult / Schizo Cluster</div>
    <div class="legend-item"><div class="legend-dot" style="background:#8faa8c"></div>Post-Rationalist / Acc Network</div>
    <div class="legend-item"><div class="legend-dot" style="background:#c49a9a"></div>Anon Underground / Edge Accounts</div>
    <div class="legend-item"><div class="legend-dot" style="background:#a8a49e"></div>Peripheral Isolates</div>
    <div style="margin-top: 10px;"></div>
    <div class="legend-item"><div class="legend-diamond" style="background:#1a1a1a"></div>Bridge node</div>
</div>
<div class="stats">
    <div>Nodes: 279</div>
    <div>Edges: 1,599</div>
    <div>Communities: 5</div>
    <div>Bridges: 15</div>
</div>
<a href="index.html" class="back-link">[ Return ]</a>
<div class="tooltip" id="tooltip">
    <div class="tt-name" id="tt-name"></div>
    <div class="tt-detail" id="tt-detail"></div>
    <div class="tt-role" id="tt-role"></div>
</div>
<script src="https://d3js.org/d3.v7.min.js"></script>
<script>
(function() {
    var communityColors = ['#8b9daf','#b5a693','#8faa8c','#c49a9a','#a8a49e'];
    var communityNames = [
        'Dissident Right / NRx Aesthetics',
        'Crypto-Occult / Schizo Cluster',
        'Post-Rationalist / Acc Network',
        'Anon Underground / Edge Accounts',
        'Peripheral Isolates'
    ];

    var width = window.innerWidth;
    var height = window.innerHeight;

    var svg = d3.select('#graph')
        .attr('width', width)
        .attr('height', height);

    var g = svg.append('g');

    var zoom = d3.zoom()
        .scaleExtent([0.3, 5])
        .on('zoom', function(event) { g.attr('transform', event.transform); });
    svg.call(zoom);

    var tooltip = document.getElementById('tooltip');
    var ttName = document.getElementById('tt-name');
    var ttDetail = document.getElementById('tt-detail');
    var ttRole = document.getElementById('tt-role');

    d3.json('community-data.json').then(function(data) {
        var nodeMap = {};
        data.nodes.forEach(function(n) { nodeMap[n.id] = n; });

        var maxPR = d3.max(data.nodes, function(d) { return d.pagerank; });

        var simulation = d3.forceSimulation(data.nodes)
            .force('link', d3.forceLink(data.links).id(function(d) { return d.id; }).distance(30).strength(0.3))
            .force('charge', d3.forceManyBody().strength(-40))
            .force('center', d3.forceCenter(width / 2, height / 2))
            .force('collision', d3.forceCollide().radius(function(d) {
                return nodeRadius(d) + 1;
            }))
            .stop();

        // Run simulation to completion (static layout)
        for (var i = 0; i < 300; i++) simulation.tick();

        var linkG = g.append('g');
        var nodeG = g.append('g');
        var labelG = g.append('g');

        var links = linkG.selectAll('line')
            .data(data.links)
            .join('line')
            .attr('x1', function(d) { return d.source.x; })
            .attr('y1', function(d) { return d.source.y; })
            .attr('x2', function(d) { return d.target.x; })
            .attr('y2', function(d) { return d.target.y; })
            .attr('stroke', '#ebebeb')
            .attr('stroke-width', 0.5);

        function nodeRadius(d) {
            if (d.role === 'bridge') return 4 + (d.pagerank / maxPR) * 12;
            if (d.role === 'hub') return 3 + (d.pagerank / maxPR) * 10;
            return 2 + (d.pagerank / maxPR) * 5;
        }

        // Peripheral nodes (circles)
        var peripheralNodes = nodeG.selectAll('.node-peripheral')
            .data(data.nodes.filter(function(d) { return d.role === 'peripheral'; }))
            .join('circle')
            .attr('class', 'node-peripheral')
            .attr('cx', function(d) { return d.x; })
            .attr('cy', function(d) { return d.y; })
            .attr('r', function(d) { return nodeRadius(d); })
            .attr('fill', function(d) { return communityColors[d.community] || '#a8a49e'; })
            .attr('stroke', '#fff')
            .attr('stroke-width', 0.5)
            .attr('opacity', 0.7)
            .style('cursor', 'pointer');

        // Hub nodes (circles, slightly more prominent)
        var hubNodes = nodeG.selectAll('.node-hub')
            .data(data.nodes.filter(function(d) { return d.role === 'hub'; }))
            .join('circle')
            .attr('class', 'node-hub')
            .attr('cx', function(d) { return d.x; })
            .attr('cy', function(d) { return d.y; })
            .attr('r', function(d) { return nodeRadius(d); })
            .attr('fill', function(d) { return communityColors[d.community] || '#a8a49e'; })
            .attr('stroke', function(d) { return d3.color(communityColors[d.community]).darker(0.5); })
            .attr('stroke-width', 1)
            .attr('opacity', 0.9)
            .style('cursor', 'pointer');

        // Bridge nodes (diamonds)
        var bridgeNodes = nodeG.selectAll('.node-bridge')
            .data(data.nodes.filter(function(d) { return d.role === 'bridge'; }))
            .join('path')
            .attr('class', 'node-bridge')
            .attr('d', function(d) {
                var r = nodeRadius(d) * 1.3;
                return 'M ' + d.x + ' ' + (d.y - r) +
                       ' L ' + (d.x + r) + ' ' + d.y +
                       ' L ' + d.x + ' ' + (d.y + r) +
                       ' L ' + (d.x - r) + ' ' + d.y + ' Z';
            })
            .attr('fill', function(d) { return communityColors[d.community] || '#a8a49e'; })
            .attr('stroke', '#1a1a1a')
            .attr('stroke-width', 1.5)
            .attr('opacity', 1)
            .style('cursor', 'pointer');

        // Labels (bridges + hubs only)
        var labeled = data.nodes.filter(function(d) { return d.role !== 'peripheral'; });
        var labels = labelG.selectAll('text')
            .data(labeled)
            .join('text')
            .attr('x', function(d) { return d.x + nodeRadius(d) + 3; })
            .attr('y', function(d) { return d.y + 3; })
            .text(function(d) { return d.id; })
            .attr('font-family', "-apple-system, BlinkMacSystemFont, 'Helvetica Neue', sans-serif")
            .attr('font-size', function(d) { return d.role === 'bridge' ? '9px' : '8px'; })
            .attr('font-weight', function(d) { return d.role === 'bridge' ? '400' : '300'; })
            .attr('fill', function(d) { return d.role === 'bridge' ? '#1a1a1a' : '#666'; })
            .attr('pointer-events', 'none');

        // All clickable elements
        var allNodeElements = nodeG.selectAll('circle, path');

        function showTooltip(event, d) {
            ttName.textContent = '@' + d.id;
            ttDetail.textContent =
                'Community: ' + communityNames[d.community] +
                '\nPageRank: ' + d.pagerank.toFixed(4) +
                '\nBetweenness: ' + d.betweenness.toFixed(4);
            var roleLabel = d.role === 'bridge' ? '◇ BRIDGE' : (d.role === 'hub' ? '● HUB' : '· PERIPHERAL');
            ttRole.textContent = roleLabel;
            ttRole.style.color = d.role === 'bridge' ? '#1a1a1a' : '#999';
            tooltip.style.display = 'block';
            tooltip.style.left = (event.pageX + 12) + 'px';
            tooltip.style.top = (event.pageY - 10) + 'px';
        }

        function hideTooltip() {
            tooltip.style.display = 'none';
        }

        allNodeElements.on('mouseover', showTooltip).on('mouseout', hideTooltip);

        // Click to isolate
        var isolated = false;
        allNodeElements.on('click', function(event, d) {
            event.stopPropagation();
            isolated = true;
            var connected = new Set();
            connected.add(d.id);
            data.links.forEach(function(l) {
                var sid = typeof l.source === 'object' ? l.source.id : l.source;
                var tid = typeof l.target === 'object' ? l.target.id : l.target;
                if (sid === d.id) connected.add(tid);
                if (tid === d.id) connected.add(sid);
            });

            allNodeElements.attr('opacity', function(n) {
                return connected.has(n.id) ? 1 : 0.05;
            });
            links.attr('opacity', function(l) {
                var sid = typeof l.source === 'object' ? l.source.id : l.source;
                var tid = typeof l.target === 'object' ? l.target.id : l.target;
                return (sid === d.id || tid === d.id) ? 0.6 : 0.02;
            });
            labels.attr('opacity', function(n) {
                return connected.has(n.id) ? 1 : 0.05;
            });
        });

        svg.on('click', function() {
            if (!isolated) return;
            isolated = false;
            peripheralNodes.attr('opacity', 0.7);
            hubNodes.attr('opacity', 0.9);
            bridgeNodes.attr('opacity', 1);
            links.attr('opacity', 1);
            labels.attr('opacity', 1);
        });

        // Search
        document.getElementById('search').addEventListener('input', function(e) {
            var q = e.target.value.toLowerCase();
            if (!q) {
                peripheralNodes.attr('opacity', 0.7);
                hubNodes.attr('opacity', 0.9);
                bridgeNodes.attr('opacity', 1);
                labels.attr('opacity', 1);
                return;
            }
            allNodeElements.attr('opacity', function(d) {
                return d.id.toLowerCase().includes(q) ? 1 : 0.05;
            });
            labels.attr('opacity', function(d) {
                return d.id.toLowerCase().includes(q) ? 1 : 0.05;
            });
        });
    });
})();
</script>
</body>
</html>
